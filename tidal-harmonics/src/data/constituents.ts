import type { Constituent } from '@/types/harmonics';

// The 37 major tidal constituents used by NOAA
// Doodson numbers: [T, s, h, p, N', p'] where:
// T = mean lunar time, s = moon's longitude, h = sun's longitude,
// p = lunar perigee, N' = lunar node, p' = solar perigee

export const CONSTITUENTS: Record<string, Constituent> = {
  // ===== SEMIDIURNAL (period ~12 hours) =====
  M2: {
    symbol: 'M2',
    name: 'Principal lunar semidiurnal',
    doodson: [2, 0, 0, 0, 0, 0],
    speed: 28.984104,
    period: 12.4206012,
    family: 'semidiurnal',
    description: 'The dominant tidal constituent, responsible for roughly 70% of total tidal range at most locations. Caused by the gravitational attraction of the Moon as it orbits Earth, producing two high tides per lunar day (24h 50m). The slightly longer period than 12 hours causes tides to shift ~50 minutes later each day.',
  },
  S2: {
    symbol: 'S2',
    name: 'Principal solar semidiurnal',
    doodson: [2, 2, -2, 0, 0, 0],
    speed: 30.0,
    period: 12.0,
    family: 'semidiurnal',
    description: 'The principal solar tide, caused by the Sun gravitational pull. Though the Sun is more massive than the Moon, its greater distance makes S2 only about 46% as strong as M2. When S2 aligns with M2 (new/full moon), spring tides occur; when 90° out of phase (quarter moons), neap tides result.',
  },
  N2: {
    symbol: 'N2',
    name: 'Larger lunar elliptic semidiurnal',
    doodson: [2, -1, 0, 1, 0, 0],
    speed: 28.439730,
    period: 12.6583,
    family: 'semidiurnal',
    description: 'Caused by the elliptical shape of the Moon orbit. As the Moon approaches perigee (closest to Earth), tidal forces strengthen. N2 accounts for this ~13% variation in lunar distance. When perigee coincides with spring tides, exceptionally high "king tides" (perigean spring tides) occur.',
  },
  K2: {
    symbol: 'K2',
    name: 'Lunisolar semidiurnal',
    doodson: [2, 2, 0, 0, 0, 0],
    speed: 30.082138,
    period: 11.9672,
    family: 'semidiurnal',
    description: 'Results from the changing declination (north-south position) of both Sun and Moon as they move above and below the equator. K2 modulates the daily inequality of tides—the difference between successive high tides or low tides. Strongest when Sun or Moon is at maximum declination (~23.5°).',
  },
  NU2: {
    symbol: 'NU2',
    name: 'Larger lunar evectional',
    doodson: [2, -1, 2, -1, 0, 0],
    speed: 28.512583,
    period: 12.6260,
    family: 'semidiurnal',
    description: 'Due to lunar evection',
  },
  MU2: {
    symbol: 'MU2',
    name: 'Variational',
    doodson: [2, -2, 2, 0, 0, 0],
    speed: 27.968208,
    period: 12.8718,
    family: 'semidiurnal',
    description: 'Due to variation in Moon speed',
  },
  '2N2': {
    symbol: '2N2',
    name: 'Lunar elliptic semidiurnal (2nd order)',
    doodson: [2, -2, 0, 2, 0, 0],
    speed: 27.895355,
    period: 12.9054,
    family: 'semidiurnal',
    description: 'Second-order elliptic effect',
  },
  L2: {
    symbol: 'L2',
    name: 'Smaller lunar elliptic semidiurnal',
    doodson: [2, 1, 0, -1, 0, 0],
    speed: 29.528479,
    period: 12.1916,
    family: 'semidiurnal',
    description: 'Smaller elliptic constituent',
  },
  T2: {
    symbol: 'T2',
    name: 'Larger solar elliptic',
    doodson: [2, 2, -3, 0, 0, 1],
    speed: 29.958933,
    period: 12.0164,
    family: 'semidiurnal',
    description: 'Due to Earth orbital eccentricity',
  },
  R2: {
    symbol: 'R2',
    name: 'Smaller solar elliptic',
    doodson: [2, 2, -1, 0, 0, -1],
    speed: 30.041067,
    period: 11.9836,
    family: 'semidiurnal',
    description: 'Smaller solar elliptic effect',
  },
  LAM2: {
    symbol: 'LAM2',
    name: 'Smaller lunar evectional',
    doodson: [2, 1, -2, 1, 0, 0],
    speed: 29.455625,
    period: 12.2218,
    family: 'semidiurnal',
    description: 'Due to lunar evection',
  },

  // ===== DIURNAL (period ~24 hours) =====
  K1: {
    symbol: 'K1',
    name: 'Lunisolar diurnal',
    doodson: [1, 1, 0, 0, 0, 0],
    speed: 15.041069,
    period: 23.9345,
    family: 'diurnal',
    description: 'The largest diurnal constituent, caused by declination of both Sun and Moon. When the Moon or Sun is north or south of the equator, it creates an asymmetry in tidal bulges, producing one high tide larger than the other. K1 is particularly important at higher latitudes and in areas with mixed tidal patterns.',
  },
  O1: {
    symbol: 'O1',
    name: 'Principal lunar diurnal',
    doodson: [1, -1, 0, 0, 0, 0],
    speed: 13.943035,
    period: 25.8193,
    family: 'diurnal',
    description: 'The principal diurnal tide from the Moon, arising from lunar declination changes over the tropical month (27.3 days). Together with K1, O1 determines the diurnal inequality—why consecutive high (or low) tides differ in height. Dominant in regions with "diurnal" tidal patterns like the Gulf of Mexico.',
  },
  P1: {
    symbol: 'P1',
    name: 'Principal solar diurnal',
    doodson: [1, 1, -2, 0, 0, 0],
    speed: 14.958931,
    period: 24.0659,
    family: 'diurnal',
    description: 'The solar counterpart to O1, caused by the Sun declination variation over the year. P1 amplitude peaks at the solstices when the Sun reaches maximum declination (±23.5°). Its exact 24-hour period (nearly) makes it nearly indistinguishable from K1 in short records, requiring year-long observations to separate.',
  },
  Q1: {
    symbol: 'Q1',
    name: 'Larger lunar elliptic diurnal',
    doodson: [1, -2, 0, 1, 0, 0],
    speed: 13.398661,
    period: 26.8684,
    family: 'diurnal',
    description: 'The diurnal equivalent of N2—caused by the Moon elliptical orbit modulating the lunar diurnal tide. Q1 varies the diurnal inequality as the Moon moves between perigee and apogee. Most noticeable in regions with strong diurnal tides.',
  },
  J1: {
    symbol: 'J1',
    name: 'Smaller lunar elliptic diurnal',
    doodson: [1, 2, 0, -1, 0, 0],
    speed: 15.585443,
    period: 23.0985,
    family: 'diurnal',
    description: 'Smaller elliptic effect',
  },
  M1: {
    symbol: 'M1',
    name: 'Smaller lunar diurnal',
    doodson: [1, 0, 0, 0, 0, 0],
    speed: 14.496694,
    period: 24.8332,
    family: 'diurnal',
    description: 'Small lunar diurnal constituent',
  },
  OO1: {
    symbol: 'OO1',
    name: 'Lunar diurnal (2nd order)',
    doodson: [1, 3, 0, 0, 0, 0],
    speed: 16.139102,
    period: 22.3061,
    family: 'diurnal',
    description: 'Second-order lunar diurnal',
  },
  S1: {
    symbol: 'S1',
    name: 'Solar diurnal',
    doodson: [1, 1, -1, 0, 0, 0],
    speed: 15.0,
    period: 24.0,
    family: 'diurnal',
    description: 'Radiational tide (thermal)',
  },
  RHO1: {
    symbol: 'RHO1',
    name: 'Larger lunar evectional diurnal',
    doodson: [1, -2, 2, -1, 0, 0],
    speed: 13.471514,
    period: 26.7231,
    family: 'diurnal',
    description: 'Due to lunar evection',
  },
  '2Q1': {
    symbol: '2Q1',
    name: 'Larger elliptic diurnal',
    doodson: [1, -3, 0, 2, 0, 0],
    speed: 12.854286,
    period: 28.0062,
    family: 'diurnal',
    description: 'Second-order elliptic diurnal',
  },

  // ===== LONG-PERIOD (period > 1 day) =====
  Mf: {
    symbol: 'Mf',
    name: 'Lunar fortnightly',
    doodson: [0, 2, 0, 0, 0, 0],
    speed: 1.098033,
    period: 327.8599,
    family: 'long-period',
    description: 'A fortnightly (~13.7 day) oscillation caused by the Moon crossing the equator twice per month. As the Moon moves from maximum north declination to maximum south and back, it creates a slow rise and fall in mean sea level. Mf contributes to the fortnightly modulation of tidal range.',
  },
  Mm: {
    symbol: 'Mm',
    name: 'Lunar monthly',
    doodson: [0, 1, 0, -1, 0, 0],
    speed: 0.544375,
    period: 661.3092,
    family: 'long-period',
    description: 'A monthly (~27.6 day) tide caused by the Moon elliptical orbit. As the Moon moves between perigee (closest) and apogee (farthest), the average tidal force changes, creating a monthly oscillation in mean water level. Mm has a small amplitude but can be detected in long tide records.',
  },
  Ssa: {
    symbol: 'Ssa',
    name: 'Solar semiannual',
    doodson: [0, 0, 2, 0, 0, 0],
    speed: 0.082137,
    period: 4383.0521,
    family: 'long-period',
    description: 'A semiannual (~182.6 day) oscillation caused by the Sun declination cycle. Sea level is slightly higher at the equinoxes when the Sun is over the equator. Also includes effects from seasonal changes in water density, wind patterns, and atmospheric pressure.',
  },
  Sa: {
    symbol: 'Sa',
    name: 'Solar annual',
    doodson: [0, 0, 1, 0, 0, 0],
    speed: 0.041069,
    period: 8766.1527,
    family: 'long-period',
    description: 'The annual (~365.25 day) tide, primarily caused by seasonal heating/cooling of ocean water, changes in prevailing winds, and the elliptical shape of Earth orbit around the Sun. Sa is often the largest long-period constituent, with amplitudes of 10-30 cm at many locations.',
  },
  MSf: {
    symbol: 'MSf',
    name: 'Lunisolar synodic fortnightly',
    doodson: [0, 2, -2, 0, 0, 0],
    speed: 1.015896,
    period: 354.3671,
    family: 'long-period',
    description: 'Due to spring-neap variation',
  },

  // ===== SHALLOW-WATER (compound/overtides) =====
  M4: {
    symbol: 'M4',
    name: 'Shallow water overtide of M2',
    doodson: [4, 0, 0, 0, 0, 0],
    speed: 57.968208,
    period: 6.2103,
    family: 'shallow-water',
    description: 'The first overtide of M2, generated when the tidal wave encounters shallow water and bottom friction. As water depth decreases, the wave becomes nonlinear: the crest speeds up (shorter under water) and the trough slows down, distorting the sinusoidal shape. M4 is the dominant "quarter-diurnal" constituent in estuaries and harbors.',
  },
  MS4: {
    symbol: 'MS4',
    name: 'Shallow water compound',
    doodson: [4, 2, -2, 0, 0, 0],
    speed: 58.984104,
    period: 6.1033,
    family: 'shallow-water',
    description: 'A compound tide arising from the nonlinear interaction between M2 and S2 in shallow water. MS4 varies with the spring-neap cycle, being largest during spring tides. It causes the flood-ebb asymmetry to change throughout the month, important for sediment transport in estuaries.',
  },
  M6: {
    symbol: 'M6',
    name: 'Shallow water overtide of M2 (2nd)',
    doodson: [6, 0, 0, 0, 0, 0],
    speed: 86.952313,
    period: 4.1402,
    family: 'shallow-water',
    description: 'The second overtide of M2 (~4.14 hour period), generated in very shallow water where nonlinear effects become even more pronounced. M6 indicates strongly distorted tides with steep flood currents and prolonged slack water periods. Important in upper estuaries and tidal flats.',
  },
  MN4: {
    symbol: 'MN4',
    name: 'Shallow water compound',
    doodson: [4, -1, 0, 1, 0, 0],
    speed: 57.423834,
    period: 6.2692,
    family: 'shallow-water',
    description: 'Compound of M2 and N2',
  },
  S4: {
    symbol: 'S4',
    name: 'Shallow water overtide of S2',
    doodson: [4, 4, -4, 0, 0, 0],
    speed: 60.0,
    period: 6.0,
    family: 'shallow-water',
    description: 'First harmonic of S2 in shallow water',
  },
  S6: {
    symbol: 'S6',
    name: 'Shallow water overtide of S2 (2nd)',
    doodson: [6, 6, -6, 0, 0, 0],
    speed: 90.0,
    period: 4.0,
    family: 'shallow-water',
    description: 'Second harmonic of S2 in shallow water',
  },
  MK3: {
    symbol: 'MK3',
    name: 'Shallow water terdiurnal',
    doodson: [3, 1, 0, 0, 0, 0],
    speed: 44.025173,
    period: 8.1771,
    family: 'shallow-water',
    description: 'Compound of M2 and K1',
  },
  '2MK3': {
    symbol: '2MK3',
    name: 'Shallow water terdiurnal',
    doodson: [3, -1, 0, 0, 0, 0],
    speed: 42.927139,
    period: 8.3863,
    family: 'shallow-water',
    description: 'Compound of 2M2 minus K1',
  },
  M8: {
    symbol: 'M8',
    name: 'Shallow water eighth diurnal',
    doodson: [8, 0, 0, 0, 0, 0],
    speed: 115.936417,
    period: 3.1052,
    family: 'shallow-water',
    description: 'Third harmonic of M2 in shallow water',
  },
};

// Sorted list of major constituents by typical amplitude
export const MAJOR_CONSTITUENTS = [
  'M2',
  'S2',
  'N2',
  'K1',
  'O1',
  'K2',
  'P1',
  'Q1',
  'M4',
  'Mf',
  'Mm',
] as const;

// Get all constituents as array
export const CONSTITUENT_LIST = Object.values(CONSTITUENTS);

// Get constituents by family
export function getConstituentsByFamily(family: string): Constituent[] {
  return CONSTITUENT_LIST.filter((c) => c.family === family);
}
