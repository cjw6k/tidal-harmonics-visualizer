import type { Constituent } from '@/types/harmonics';

// The 37 major tidal constituents used by NOAA
// Doodson numbers: [T, s, h, p, N', p'] where:
// T = mean lunar time, s = moon's longitude, h = sun's longitude,
// p = lunar perigee, N' = lunar node, p' = solar perigee

export const CONSTITUENTS: Record<string, Constituent> = {
  // ===== SEMIDIURNAL (period ~12 hours) =====
  M2: {
    symbol: 'M2',
    name: 'Principal lunar semidiurnal',
    doodson: [2, 0, 0, 0, 0, 0],
    speed: 28.984104,
    period: 12.4206012,
    family: 'semidiurnal',
    description: 'Largest tidal constituent, caused by the Moon',
  },
  S2: {
    symbol: 'S2',
    name: 'Principal solar semidiurnal',
    doodson: [2, 2, -2, 0, 0, 0],
    speed: 30.0,
    period: 12.0,
    family: 'semidiurnal',
    description: 'Caused by the Sun, creates spring/neap cycle with M2',
  },
  N2: {
    symbol: 'N2',
    name: 'Larger lunar elliptic semidiurnal',
    doodson: [2, -1, 0, 1, 0, 0],
    speed: 28.439730,
    period: 12.6583,
    family: 'semidiurnal',
    description: 'Due to variation in Moon distance (elliptic orbit)',
  },
  K2: {
    symbol: 'K2',
    name: 'Lunisolar semidiurnal',
    doodson: [2, 2, 0, 0, 0, 0],
    speed: 30.082138,
    period: 11.9672,
    family: 'semidiurnal',
    description: 'Due to changes in declination of Sun and Moon',
  },
  NU2: {
    symbol: 'NU2',
    name: 'Larger lunar evectional',
    doodson: [2, -1, 2, -1, 0, 0],
    speed: 28.512583,
    period: 12.6260,
    family: 'semidiurnal',
    description: 'Due to lunar evection',
  },
  MU2: {
    symbol: 'MU2',
    name: 'Variational',
    doodson: [2, -2, 2, 0, 0, 0],
    speed: 27.968208,
    period: 12.8718,
    family: 'semidiurnal',
    description: 'Due to variation in Moon speed',
  },
  '2N2': {
    symbol: '2N2',
    name: 'Lunar elliptic semidiurnal (2nd order)',
    doodson: [2, -2, 0, 2, 0, 0],
    speed: 27.895355,
    period: 12.9054,
    family: 'semidiurnal',
    description: 'Second-order elliptic effect',
  },
  L2: {
    symbol: 'L2',
    name: 'Smaller lunar elliptic semidiurnal',
    doodson: [2, 1, 0, -1, 0, 0],
    speed: 29.528479,
    period: 12.1916,
    family: 'semidiurnal',
    description: 'Smaller elliptic constituent',
  },
  T2: {
    symbol: 'T2',
    name: 'Larger solar elliptic',
    doodson: [2, 2, -3, 0, 0, 1],
    speed: 29.958933,
    period: 12.0164,
    family: 'semidiurnal',
    description: 'Due to Earth orbital eccentricity',
  },
  R2: {
    symbol: 'R2',
    name: 'Smaller solar elliptic',
    doodson: [2, 2, -1, 0, 0, -1],
    speed: 30.041067,
    period: 11.9836,
    family: 'semidiurnal',
    description: 'Smaller solar elliptic effect',
  },
  LAM2: {
    symbol: 'LAM2',
    name: 'Smaller lunar evectional',
    doodson: [2, 1, -2, 1, 0, 0],
    speed: 29.455625,
    period: 12.2218,
    family: 'semidiurnal',
    description: 'Due to lunar evection',
  },

  // ===== DIURNAL (period ~24 hours) =====
  K1: {
    symbol: 'K1',
    name: 'Lunisolar diurnal',
    doodson: [1, 1, 0, 0, 0, 0],
    speed: 15.041069,
    period: 23.9345,
    family: 'diurnal',
    description: 'Due to declination of Sun and Moon',
  },
  O1: {
    symbol: 'O1',
    name: 'Principal lunar diurnal',
    doodson: [1, -1, 0, 0, 0, 0],
    speed: 13.943035,
    period: 25.8193,
    family: 'diurnal',
    description: 'Main lunar diurnal constituent',
  },
  P1: {
    symbol: 'P1',
    name: 'Principal solar diurnal',
    doodson: [1, 1, -2, 0, 0, 0],
    speed: 14.958931,
    period: 24.0659,
    family: 'diurnal',
    description: 'Main solar diurnal constituent',
  },
  Q1: {
    symbol: 'Q1',
    name: 'Larger lunar elliptic diurnal',
    doodson: [1, -2, 0, 1, 0, 0],
    speed: 13.398661,
    period: 26.8684,
    family: 'diurnal',
    description: 'Due to Moon elliptic orbit',
  },
  J1: {
    symbol: 'J1',
    name: 'Smaller lunar elliptic diurnal',
    doodson: [1, 2, 0, -1, 0, 0],
    speed: 15.585443,
    period: 23.0985,
    family: 'diurnal',
    description: 'Smaller elliptic effect',
  },
  M1: {
    symbol: 'M1',
    name: 'Smaller lunar diurnal',
    doodson: [1, 0, 0, 0, 0, 0],
    speed: 14.496694,
    period: 24.8332,
    family: 'diurnal',
    description: 'Small lunar diurnal constituent',
  },
  OO1: {
    symbol: 'OO1',
    name: 'Lunar diurnal (2nd order)',
    doodson: [1, 3, 0, 0, 0, 0],
    speed: 16.139102,
    period: 22.3061,
    family: 'diurnal',
    description: 'Second-order lunar diurnal',
  },
  S1: {
    symbol: 'S1',
    name: 'Solar diurnal',
    doodson: [1, 1, -1, 0, 0, 0],
    speed: 15.0,
    period: 24.0,
    family: 'diurnal',
    description: 'Radiational tide (thermal)',
  },
  RHO1: {
    symbol: 'RHO1',
    name: 'Larger lunar evectional diurnal',
    doodson: [1, -2, 2, -1, 0, 0],
    speed: 13.471514,
    period: 26.7231,
    family: 'diurnal',
    description: 'Due to lunar evection',
  },
  '2Q1': {
    symbol: '2Q1',
    name: 'Larger elliptic diurnal',
    doodson: [1, -3, 0, 2, 0, 0],
    speed: 12.854286,
    period: 28.0062,
    family: 'diurnal',
    description: 'Second-order elliptic diurnal',
  },

  // ===== LONG-PERIOD (period > 1 day) =====
  Mf: {
    symbol: 'Mf',
    name: 'Lunar fortnightly',
    doodson: [0, 2, 0, 0, 0, 0],
    speed: 1.098033,
    period: 327.8599,
    family: 'long-period',
    description: 'Fortnightly tide due to Moon declination',
  },
  Mm: {
    symbol: 'Mm',
    name: 'Lunar monthly',
    doodson: [0, 1, 0, -1, 0, 0],
    speed: 0.544375,
    period: 661.3092,
    family: 'long-period',
    description: 'Monthly tide due to Moon distance variation',
  },
  Ssa: {
    symbol: 'Ssa',
    name: 'Solar semiannual',
    doodson: [0, 0, 2, 0, 0, 0],
    speed: 0.082137,
    period: 4383.0521,
    family: 'long-period',
    description: 'Semiannual tide due to Sun declination',
  },
  Sa: {
    symbol: 'Sa',
    name: 'Solar annual',
    doodson: [0, 0, 1, 0, 0, 0],
    speed: 0.041069,
    period: 8766.1527,
    family: 'long-period',
    description: 'Annual tide due to solar heating and Earth orbit',
  },
  MSf: {
    symbol: 'MSf',
    name: 'Lunisolar synodic fortnightly',
    doodson: [0, 2, -2, 0, 0, 0],
    speed: 1.015896,
    period: 354.3671,
    family: 'long-period',
    description: 'Due to spring-neap variation',
  },

  // ===== SHALLOW-WATER (compound/overtides) =====
  M4: {
    symbol: 'M4',
    name: 'Shallow water overtide of M2',
    doodson: [4, 0, 0, 0, 0, 0],
    speed: 57.968208,
    period: 6.2103,
    family: 'shallow-water',
    description: 'First harmonic of M2 in shallow water',
  },
  MS4: {
    symbol: 'MS4',
    name: 'Shallow water compound',
    doodson: [4, 2, -2, 0, 0, 0],
    speed: 58.984104,
    period: 6.1033,
    family: 'shallow-water',
    description: 'Compound of M2 and S2',
  },
  M6: {
    symbol: 'M6',
    name: 'Shallow water overtide of M2 (2nd)',
    doodson: [6, 0, 0, 0, 0, 0],
    speed: 86.952313,
    period: 4.1402,
    family: 'shallow-water',
    description: 'Second harmonic of M2 in shallow water',
  },
  MN4: {
    symbol: 'MN4',
    name: 'Shallow water compound',
    doodson: [4, -1, 0, 1, 0, 0],
    speed: 57.423834,
    period: 6.2692,
    family: 'shallow-water',
    description: 'Compound of M2 and N2',
  },
  S4: {
    symbol: 'S4',
    name: 'Shallow water overtide of S2',
    doodson: [4, 4, -4, 0, 0, 0],
    speed: 60.0,
    period: 6.0,
    family: 'shallow-water',
    description: 'First harmonic of S2 in shallow water',
  },
  S6: {
    symbol: 'S6',
    name: 'Shallow water overtide of S2 (2nd)',
    doodson: [6, 6, -6, 0, 0, 0],
    speed: 90.0,
    period: 4.0,
    family: 'shallow-water',
    description: 'Second harmonic of S2 in shallow water',
  },
  MK3: {
    symbol: 'MK3',
    name: 'Shallow water terdiurnal',
    doodson: [3, 1, 0, 0, 0, 0],
    speed: 44.025173,
    period: 8.1771,
    family: 'shallow-water',
    description: 'Compound of M2 and K1',
  },
  '2MK3': {
    symbol: '2MK3',
    name: 'Shallow water terdiurnal',
    doodson: [3, -1, 0, 0, 0, 0],
    speed: 42.927139,
    period: 8.3863,
    family: 'shallow-water',
    description: 'Compound of 2M2 minus K1',
  },
  M8: {
    symbol: 'M8',
    name: 'Shallow water eighth diurnal',
    doodson: [8, 0, 0, 0, 0, 0],
    speed: 115.936417,
    period: 3.1052,
    family: 'shallow-water',
    description: 'Third harmonic of M2 in shallow water',
  },
};

// Sorted list of major constituents by typical amplitude
export const MAJOR_CONSTITUENTS = [
  'M2',
  'S2',
  'N2',
  'K1',
  'O1',
  'K2',
  'P1',
  'Q1',
  'M4',
  'Mf',
  'Mm',
] as const;

// Get all constituents as array
export const CONSTITUENT_LIST = Object.values(CONSTITUENTS);

// Get constituents by family
export function getConstituentsByFamily(family: string): Constituent[] {
  return CONSTITUENT_LIST.filter((c) => c.family === family);
}
