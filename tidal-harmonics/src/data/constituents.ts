import type { Constituent } from '@/types/harmonics';

// The 37 major tidal constituents used by NOAA
// Doodson numbers: [T, s, h, p, N', p'] where:
// T = mean lunar time, s = moon's longitude, h = sun's longitude,
// p = lunar perigee, N' = lunar node, p' = solar perigee

export const CONSTITUENTS: Record<string, Constituent> = {
  // ===== SEMIDIURNAL (period ~12 hours) =====
  M2: {
    symbol: 'M2',
    name: 'Principal lunar semidiurnal',
    doodson: [2, 0, 0, 0, 0, 0],
    speed: 28.984104,
    period: 12.4206012,
    family: 'semidiurnal',
    description: 'The dominant tidal constituent, responsible for roughly 70% of total tidal range at most locations. Caused by the gravitational attraction of the Moon as it orbits Earth, producing two high tides per lunar day (24h 50m). The slightly longer period than 12 hours causes tides to shift ~50 minutes later each day.',
  },
  S2: {
    symbol: 'S2',
    name: 'Principal solar semidiurnal',
    doodson: [2, 2, -2, 0, 0, 0],
    speed: 30.0,
    period: 12.0,
    family: 'semidiurnal',
    description: 'The principal solar tide, caused by the Sun gravitational pull. Though the Sun is more massive than the Moon, its greater distance makes S2 only about 46% as strong as M2. When S2 aligns with M2 (new/full moon), spring tides occur; when 90° out of phase (quarter moons), neap tides result.',
  },
  N2: {
    symbol: 'N2',
    name: 'Larger lunar elliptic semidiurnal',
    doodson: [2, -1, 0, 1, 0, 0],
    speed: 28.439730,
    period: 12.6583,
    family: 'semidiurnal',
    description: 'Caused by the elliptical shape of the Moon orbit. As the Moon approaches perigee (closest to Earth), tidal forces strengthen. N2 accounts for this ~13% variation in lunar distance. When perigee coincides with spring tides, exceptionally high "king tides" (perigean spring tides) occur.',
  },
  K2: {
    symbol: 'K2',
    name: 'Lunisolar semidiurnal',
    doodson: [2, 2, 0, 0, 0, 0],
    speed: 30.082138,
    period: 11.9672,
    family: 'semidiurnal',
    description: 'Results from the changing declination (north-south position) of both Sun and Moon as they move above and below the equator. K2 modulates the daily inequality of tides—the difference between successive high tides or low tides. Strongest when Sun or Moon is at maximum declination (~23.5°).',
  },
  NU2: {
    symbol: 'NU2',
    name: 'Larger lunar evectional',
    doodson: [2, -1, 2, -1, 0, 0],
    speed: 28.512583,
    period: 12.6260,
    family: 'semidiurnal',
    description: 'Arises from lunar evection—the largest perturbation in the Moon\'s orbit caused by the Sun\'s gravitational pull. Evection makes the lunar orbit alternately more and less elliptical with a period of ~31.8 days. NU2 modulates the strength of lunar tides throughout this cycle, making it important for accurate monthly predictions.',
  },
  MU2: {
    symbol: 'MU2',
    name: 'Variational',
    doodson: [2, -2, 2, 0, 0, 0],
    speed: 27.968208,
    period: 12.8718,
    family: 'semidiurnal',
    description: 'Caused by the "variation"—a speeding up and slowing down of the Moon as it orbits Earth. The Moon moves faster when between Earth and Sun (new moon) and slower when opposite (full moon). This ~14.8-day cycle slightly alters the timing and height of tides, requiring MU2 for sub-centimeter accuracy.',
  },
  '2N2': {
    symbol: '2N2',
    name: 'Lunar elliptic semidiurnal (2nd order)',
    doodson: [2, -2, 0, 2, 0, 0],
    speed: 27.895355,
    period: 12.9054,
    family: 'semidiurnal',
    description: 'A second-order correction for the Moon\'s elliptical orbit. While N2 captures the main perigee-apogee effect, 2N2 accounts for higher-order terms in the orbital mathematics. Though small, 2N2 improves predictions during extreme perigee events when the Moon is exceptionally close to Earth.',
  },
  L2: {
    symbol: 'L2',
    name: 'Smaller lunar elliptic semidiurnal',
    doodson: [2, 1, 0, -1, 0, 0],
    speed: 29.528479,
    period: 12.1916,
    family: 'semidiurnal',
    description: 'The smaller counterpart to N2, arising from the Moon\'s orbital eccentricity. L2 represents the opposite phase of the elliptic variation—while N2 peaks near perigee, L2 captures effects that peak near apogee. Together, N2 and L2 fully describe the first-order elliptic modulation of lunar tides.',
  },
  T2: {
    symbol: 'T2',
    name: 'Larger solar elliptic',
    doodson: [2, 2, -3, 0, 0, 1],
    speed: 29.958933,
    period: 12.0164,
    family: 'semidiurnal',
    description: 'Accounts for the elliptical shape of Earth\'s orbit around the Sun. Earth is ~3% closer to the Sun at perihelion (January) than aphelion (July), causing solar tidal forces to vary by about 6% annually. T2 captures this seasonal modulation of the solar semidiurnal tide.',
  },
  R2: {
    symbol: 'R2',
    name: 'Smaller solar elliptic',
    doodson: [2, 2, -1, 0, 0, -1],
    speed: 30.041067,
    period: 11.9836,
    family: 'semidiurnal',
    description: 'The smaller companion to T2, completing the description of how Earth\'s elliptical orbit modulates solar tides. R2 captures the phase-shifted component of the annual orbital variation. It\'s small but necessary for precise modeling of the solar contribution to tides.',
  },
  LAM2: {
    symbol: 'LAM2',
    name: 'Smaller lunar evectional',
    doodson: [2, 1, -2, 1, 0, 0],
    speed: 29.455625,
    period: 12.2218,
    family: 'semidiurnal',
    description: 'The smaller component of lunar evection effects, complementing NU2. While NU2 captures the main evection signal, LAM2 represents a phase-shifted term needed for complete representation. Together they account for how the Sun\'s gravity distorts the Moon\'s orbit over the ~31.8-day evection cycle.',
  },

  // ===== DIURNAL (period ~24 hours) =====
  K1: {
    symbol: 'K1',
    name: 'Lunisolar diurnal',
    doodson: [1, 1, 0, 0, 0, 0],
    speed: 15.041069,
    period: 23.9345,
    family: 'diurnal',
    description: 'The largest diurnal constituent, caused by declination of both Sun and Moon. When the Moon or Sun is north or south of the equator, it creates an asymmetry in tidal bulges, producing one high tide larger than the other. K1 is particularly important at higher latitudes and in areas with mixed tidal patterns.',
  },
  O1: {
    symbol: 'O1',
    name: 'Principal lunar diurnal',
    doodson: [1, -1, 0, 0, 0, 0],
    speed: 13.943035,
    period: 25.8193,
    family: 'diurnal',
    description: 'The principal diurnal tide from the Moon, arising from lunar declination changes over the tropical month (27.3 days). Together with K1, O1 determines the diurnal inequality—why consecutive high (or low) tides differ in height. Dominant in regions with "diurnal" tidal patterns like the Gulf of Mexico.',
  },
  P1: {
    symbol: 'P1',
    name: 'Principal solar diurnal',
    doodson: [1, 1, -2, 0, 0, 0],
    speed: 14.958931,
    period: 24.0659,
    family: 'diurnal',
    description: 'The solar counterpart to O1, caused by the Sun declination variation over the year. P1 amplitude peaks at the solstices when the Sun reaches maximum declination (±23.5°). Its exact 24-hour period (nearly) makes it nearly indistinguishable from K1 in short records, requiring year-long observations to separate.',
  },
  Q1: {
    symbol: 'Q1',
    name: 'Larger lunar elliptic diurnal',
    doodson: [1, -2, 0, 1, 0, 0],
    speed: 13.398661,
    period: 26.8684,
    family: 'diurnal',
    description: 'The diurnal equivalent of N2—caused by the Moon elliptical orbit modulating the lunar diurnal tide. Q1 varies the diurnal inequality as the Moon moves between perigee and apogee. Most noticeable in regions with strong diurnal tides.',
  },
  J1: {
    symbol: 'J1',
    name: 'Smaller lunar elliptic diurnal',
    doodson: [1, 2, 0, -1, 0, 0],
    speed: 15.585443,
    period: 23.0985,
    family: 'diurnal',
    description: 'The diurnal counterpart to L2, capturing how the Moon\'s elliptical orbit affects the diurnal tide. J1 represents the faster-rotating component of elliptic modulation, while Q1 represents the slower component. Together they fully describe the perigee-apogee effect on daily tide inequality.',
  },
  M1: {
    symbol: 'M1',
    name: 'Smaller lunar diurnal',
    doodson: [1, 0, 0, 0, 0, 0],
    speed: 14.496694,
    period: 24.8332,
    family: 'diurnal',
    description: 'A small diurnal constituent arising from the interaction between the Moon\'s orbital motion and Earth\'s rotation. M1 is generated through nonlinear ocean response and is typically small except in certain resonant basins. Its period matches the mean lunar day (24h 50m).',
  },
  OO1: {
    symbol: 'OO1',
    name: 'Lunar diurnal (2nd order)',
    doodson: [1, 3, 0, 0, 0, 0],
    speed: 16.139102,
    period: 22.3061,
    family: 'diurnal',
    description: 'A second-order diurnal constituent arising from the Moon\'s declination. While K1 captures the primary effect of lunar declination, OO1 represents higher-order terms that become important when the Moon reaches maximum declination (±28.5° during major lunar standstills). Has the shortest period of the major diurnal constituents.',
  },
  S1: {
    symbol: 'S1',
    name: 'Solar diurnal',
    doodson: [1, 1, -1, 0, 0, 0],
    speed: 15.0,
    period: 24.0,
    family: 'diurnal',
    description: 'A unique "radiational tide" driven primarily by the daily heating cycle of the Sun rather than direct gravitational attraction. Solar heating causes sea surface temperature and atmospheric pressure to vary with an exact 24-hour period, creating a tide indistinguishable from a gravitational S1. Often the largest non-gravitational tidal signal.',
  },
  RHO1: {
    symbol: 'RHO1',
    name: 'Larger lunar evectional diurnal',
    doodson: [1, -2, 2, -1, 0, 0],
    speed: 13.471514,
    period: 26.7231,
    family: 'diurnal',
    description: 'The diurnal signature of lunar evection—the ~31.8-day variation in the Moon\'s orbital shape caused by solar perturbation. RHO1 modulates the diurnal tide inequality throughout the evection cycle. Most noticeable in regions with strong diurnal tides where subtle modulations accumulate.',
  },
  '2Q1': {
    symbol: '2Q1',
    name: 'Larger elliptic diurnal',
    doodson: [1, -3, 0, 2, 0, 0],
    speed: 12.854286,
    period: 28.0062,
    family: 'diurnal',
    description: 'A second-order elliptic constituent with the longest period of the major diurnal tides (~28 hours). 2Q1 captures the combined effect of the Moon\'s elliptical orbit and its declination variation. Though small, it\'s necessary for accurate predictions of extreme diurnal tides during perigee.',
  },

  // ===== LONG-PERIOD (period > 1 day) =====
  Mf: {
    symbol: 'Mf',
    name: 'Lunar fortnightly',
    doodson: [0, 2, 0, 0, 0, 0],
    speed: 1.098033,
    period: 327.8599,
    family: 'long-period',
    description: 'A fortnightly (~13.7 day) oscillation caused by the Moon crossing the equator twice per month. As the Moon moves from maximum north declination to maximum south and back, it creates a slow rise and fall in mean sea level. Mf contributes to the fortnightly modulation of tidal range.',
  },
  Mm: {
    symbol: 'Mm',
    name: 'Lunar monthly',
    doodson: [0, 1, 0, -1, 0, 0],
    speed: 0.544375,
    period: 661.3092,
    family: 'long-period',
    description: 'A monthly (~27.6 day) tide caused by the Moon elliptical orbit. As the Moon moves between perigee (closest) and apogee (farthest), the average tidal force changes, creating a monthly oscillation in mean water level. Mm has a small amplitude but can be detected in long tide records.',
  },
  Ssa: {
    symbol: 'Ssa',
    name: 'Solar semiannual',
    doodson: [0, 0, 2, 0, 0, 0],
    speed: 0.082137,
    period: 4383.0521,
    family: 'long-period',
    description: 'A semiannual (~182.6 day) oscillation caused by the Sun declination cycle. Sea level is slightly higher at the equinoxes when the Sun is over the equator. Also includes effects from seasonal changes in water density, wind patterns, and atmospheric pressure.',
  },
  Sa: {
    symbol: 'Sa',
    name: 'Solar annual',
    doodson: [0, 0, 1, 0, 0, 0],
    speed: 0.041069,
    period: 8766.1527,
    family: 'long-period',
    description: 'The annual (~365.25 day) tide, primarily caused by seasonal heating/cooling of ocean water, changes in prevailing winds, and the elliptical shape of Earth orbit around the Sun. Sa is often the largest long-period constituent, with amplitudes of 10-30 cm at many locations.',
  },
  MSf: {
    symbol: 'MSf',
    name: 'Lunisolar synodic fortnightly',
    doodson: [0, 2, -2, 0, 0, 0],
    speed: 1.015896,
    period: 354.3671,
    family: 'long-period',
    description: 'Tracks the spring-neap cycle by measuring the ~14.8-day synodic month (new moon to new moon). MSf is the long-period component of the beat between M2 and S2—as these semidiurnal tides go in and out of phase, they create both the familiar spring-neap variation and this slow oscillation in mean sea level.',
  },

  // ===== SHALLOW-WATER (compound/overtides) =====
  M4: {
    symbol: 'M4',
    name: 'Shallow water overtide of M2',
    doodson: [4, 0, 0, 0, 0, 0],
    speed: 57.968208,
    period: 6.2103,
    family: 'shallow-water',
    description: 'The first overtide of M2, generated when the tidal wave encounters shallow water and bottom friction. As water depth decreases, the wave becomes nonlinear: the crest speeds up (shorter under water) and the trough slows down, distorting the sinusoidal shape. M4 is the dominant "quarter-diurnal" constituent in estuaries and harbors.',
  },
  MS4: {
    symbol: 'MS4',
    name: 'Shallow water compound',
    doodson: [4, 2, -2, 0, 0, 0],
    speed: 58.984104,
    period: 6.1033,
    family: 'shallow-water',
    description: 'A compound tide arising from the nonlinear interaction between M2 and S2 in shallow water. MS4 varies with the spring-neap cycle, being largest during spring tides. It causes the flood-ebb asymmetry to change throughout the month, important for sediment transport in estuaries.',
  },
  M6: {
    symbol: 'M6',
    name: 'Shallow water overtide of M2 (2nd)',
    doodson: [6, 0, 0, 0, 0, 0],
    speed: 86.952313,
    period: 4.1402,
    family: 'shallow-water',
    description: 'The second overtide of M2 (~4.14 hour period), generated in very shallow water where nonlinear effects become even more pronounced. M6 indicates strongly distorted tides with steep flood currents and prolonged slack water periods. Important in upper estuaries and tidal flats.',
  },
  MN4: {
    symbol: 'MN4',
    name: 'Shallow water compound',
    doodson: [4, -1, 0, 1, 0, 0],
    speed: 57.423834,
    period: 6.2692,
    family: 'shallow-water',
    description: 'A compound tide from the nonlinear interaction between M2 and N2 in shallow water. MN4 varies with the lunar perigee-apogee cycle, being strongest when the Moon is closest to Earth. It adds a fortnightly modulation to the quarter-diurnal tides, important for predicting maximum tidal currents.',
  },
  S4: {
    symbol: 'S4',
    name: 'Shallow water overtide of S2',
    doodson: [4, 4, -4, 0, 0, 0],
    speed: 60.0,
    period: 6.0,
    family: 'shallow-water',
    description: 'The first overtide of the solar semidiurnal tide S2, generated by nonlinear shallow water effects. With its exact 6-hour period (4 cycles per day), S4 has a simple relationship with clock time. It modulates with the spring-neap cycle, being largest when S2 is strongest (at spring tides).',
  },
  S6: {
    symbol: 'S6',
    name: 'Shallow water overtide of S2 (2nd)',
    doodson: [6, 6, -6, 0, 0, 0],
    speed: 90.0,
    period: 4.0,
    family: 'shallow-water',
    description: 'The second overtide of S2, with an exact 4-hour period (6 cycles per day). S6 indicates strongly nonlinear distortion of the solar tide and is typically only significant in very shallow estuaries where the tide wave becomes severely asymmetric. Rarely used except in detailed harbor models.',
  },
  MK3: {
    symbol: 'MK3',
    name: 'Shallow water terdiurnal',
    doodson: [3, 1, 0, 0, 0, 0],
    speed: 44.025173,
    period: 8.1771,
    family: 'shallow-water',
    description: 'A terdiurnal (3 cycles/day) compound tide from the interaction between M2 and K1 in shallow water. MK3 is the dominant ~8-hour constituent and indicates coupling between semidiurnal and diurnal tides. Particularly important in channels where both tidal types have significant amplitude.',
  },
  '2MK3': {
    symbol: '2MK3',
    name: 'Shallow water terdiurnal',
    doodson: [3, -1, 0, 0, 0, 0],
    speed: 42.927139,
    period: 8.3863,
    family: 'shallow-water',
    description: 'The second major terdiurnal constituent, arising from the difference interaction (2×M2 - K1) in shallow water. Together with MK3, 2MK3 fully describes the terdiurnal tide. The pair produces a beat pattern that modulates with the declination cycle, affecting tidal currents at ~8-hour periods.',
  },
  M8: {
    symbol: 'M8',
    name: 'Shallow water eighth diurnal',
    doodson: [8, 0, 0, 0, 0, 0],
    speed: 115.936417,
    period: 3.1052,
    family: 'shallow-water',
    description: 'The third overtide of M2, indicating extreme nonlinear distortion in very shallow water. With 8 cycles per lunar day (~3.1-hour period), M8 is only measurable in the shallowest estuaries where the tidal curve becomes sawtooth-shaped. Its presence signals conditions challenging for navigation.',
  },
};

// Sorted list of major constituents by typical amplitude
export const MAJOR_CONSTITUENTS = [
  'M2',
  'S2',
  'N2',
  'K1',
  'O1',
  'K2',
  'P1',
  'Q1',
  'M4',
  'Mf',
  'Mm',
] as const;

// Get all constituents as array
export const CONSTITUENT_LIST = Object.values(CONSTITUENTS);

// Get constituents by family
export function getConstituentsByFamily(family: string): Constituent[] {
  return CONSTITUENT_LIST.filter((c) => c.family === family);
}
